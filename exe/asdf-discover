#!/usr/bin/env ruby

require "asdf_discover"
require "fileutils"

FileUtils.cd(ARGV.first) if ARGV.first

if File.exist?(AsdfDiscover::TOOL_VERSIONS)
  puts "#{AsdfDiscover::TOOL_VERSIONS} already exists!"
  exit(1)
end

result = AsdfDiscover.search

unless result.consistent?
  result.conflicts.each do |conflict|
    puts "Found multiple versions for #{conflict.language}:"

    conflict.sources.each do |source|
      puts "  - #{source.version} from #{source.source}"
    end
    puts
  end
end
